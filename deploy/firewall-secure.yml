# VERIFY:
# 1. > ufw status
# 2. > sudo netstat -ntlp | grep LISTEN
# 3. > ufw status verbose                # this will give the default policy
# 4. > Server and client check: On server do: sudo nc -l 77
#                          On client do: telnet ip 77
#                          > ufw disable
#                          Repeat above 2 commands
#                          > ufw emable
- name: Making network layer more secure
  hosts: 127.0.0.1
  connection: local
  become: yes
  become_user: root

  tasks:
    - name: Install a list of packages
      apt:
        pkg:
          - python
          - ufw
          - fail2ban
          - unattended-upgrades
          - logwatch

    - name: Enable ufw/firewall
      ufw:
        state: enabled
        policy: deny

    - name: Allow all access to tcp port 80
      ufw:
        rule: allow
        port: "80"
        proto: tcp

    - name: Allow all access to tcp port 443
      ufw:
        rule: allow
        port: "443"
        proto: tcp

    - name: Allow all access to tcp port 90
      ufw:
        rule: allow
        port: "90"
        proto: tcp
